---
import Layout from '@/layouts/Layout.astro'
import { getCollection } from 'astro:content'

// Get all blog posts
const allPosts = await getCollection('blog')
const publishedPosts = allPosts
  .filter(post => !post.data.featured)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())

const pageTitle = 'Blog'
const pageDescription =
  'Explore our latest articles and tutorials on modern web development, Astro, and building scalable, fast websites.'
---

<Layout title={pageTitle} description={pageDescription}>
  <main id='main-content' class='container mx-auto px-4 py-16'>
    <div class='mx-auto max-w-4xl'>
      <h1 class='mb-4 text-4xl font-bold md:text-5xl'>Blog</h1>
      <p class='text-muted-foreground mb-12 text-xl'>Insights and tutorials about modern web development</p>

      <div class='space-y-8'>
        {
          publishedPosts.map(post => (
            <article class='border-b pb-8'>
              <a href={`/blog/${post.id}`} class='group'>
                <h2 class='group-hover:text-primary mb-2 text-2xl font-bold transition-colors md:text-3xl'>
                  {post.data.title}
                </h2>
                <p class='text-muted-foreground mb-4'>{post.data.description}</p>
                <div class='text-muted-foreground flex items-center gap-4 text-sm'>
                  <time datetime={post.data.pubDate.toISOString()}>
                    {post.data.pubDate.toLocaleDateString('en-US', {
                      year: 'numeric',
                      month: 'long',
                      day: 'numeric'
                    })}
                  </time>
                  <span>Â·</span>
                  <span>{post.data.author}</span>
                </div>
              </a>
            </article>
          ))
        }
      </div>

      {
        publishedPosts.length === 0 && (
          <p class='text-muted-foreground py-12 text-center'>No blog posts available yet. Check back soon!</p>
        )
      }
    </div>
  </main>
</Layout>
